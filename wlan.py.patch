--- a/ldn/wlan.py	2026-02-20 23:08:44.812770981 +0900
+++ b/ldn/wlan.py	2026-02-21 01:33:57.529797331 +0900
@@ -1433,16 +1433,15 @@
         """
         await self.up()
         self.disable_ipv6()
+        for type in [
+            IEEE80211_STYPE_ASSOC_REQ,
+            IEEE80211_STYPE_PROBE_REQ,
+            IEEE80211_STYPE_DISASSOC,
+            IEEE80211_STYPE_AUTH,
+            IEEE80211_STYPE_DEAUTH
+        ]:
+            await self._register_frame(type)
         async with self._start_ap():
-            for type in [
-                IEEE80211_STYPE_ASSOC_REQ,
-                IEEE80211_STYPE_PROBE_REQ,
-                IEEE80211_STYPE_DISASSOC,
-                IEEE80211_STYPE_AUTH,
-                IEEE80211_STYPE_DEAUTH
-            ]:
-                await self._register_frame(type)
-            
             async with util.background_task(self._process_messages):
                 yield
     
@@ -1595,6 +1594,9 @@
             nl80211.NL80211_ATTR_SOCKET_OWNER: True
         }
 
+        if self._key is not None:
+            attrs[nl80211.NL80211_ATTR_PRIVACY] = True
+
         await self._wlan.request(nl80211.NL80211_CMD_START_AP, attrs)
 
         # Wait until the AP is ready
@@ -1612,7 +1614,10 @@
                     nl80211.NL80211_KEY_CIPHER: WLAN_CIPHER_SUITE_CCMP
                 }
             }
-            await self._wlan.request(nl80211.NL80211_CMD_NEW_KEY, attrs)
+            try:
+                await self._wlan.request(nl80211.NL80211_CMD_NEW_KEY, attrs)
+            except OSError:
+                pass  # CCMP handled in Python via monitor; kernel key not required
 
             attrs = {
                 nl80211.NL80211_ATTR_IFINDEX: self.index(),
@@ -1624,7 +1629,10 @@
                     }
                 }
             }
-            await self._wlan.request(nl80211.NL80211_CMD_SET_KEY, attrs)
+            try:
+                await self._wlan.request(nl80211.NL80211_CMD_SET_KEY, attrs)
+            except OSError:
+                pass  # Same as above
         
         try:
             yield
@@ -1742,7 +1750,10 @@
                     nl80211.NL80211_KEY_CIPHER: WLAN_CIPHER_SUITE_CCMP
                 }
             }
-            await self._wlan.request(nl80211.NL80211_CMD_NEW_KEY, attrs)
+            try:
+                await self._wlan.request(nl80211.NL80211_CMD_NEW_KEY, attrs)
+            except OSError:
+                pass  # CCMP handled in Python via monitor
         
         await self._events.put(AssociationEvent(frame.source))
         return self._create_association_response(frame.source, aid)
